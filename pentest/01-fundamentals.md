# ğŸ“š Security Fundamentals

> Kiáº¿n thá»©c ná»n táº£ng cáº§n náº¯m vá»¯ng trÆ°á»›c khi há»c Pentest

---

## 1. Networking Basics

### 1.1 TCP/IP Model

```
Application Layer    â”€â”€â”€ HTTP, HTTPS, FTP, DNS
Transport Layer      â”€â”€â”€ TCP, UDP
Internet Layer       â”€â”€â”€ IP, ICMP
Network Access Layer â”€â”€â”€ Ethernet, WiFi
```

**Táº¡i sao quan trá»ng?** Hiá»ƒu cÃ¡ch data di chuyá»ƒn giÃºp báº¡n biáº¿t Ä‘Æ°á»£c Ä‘iá»ƒm nÃ o cÃ³ thá»ƒ bá»‹ intercept hoáº·c manipulate.

### 1.2 Common Ports

| Port  | Service    | MÃ´ táº£                  |
| ----- | ---------- | ------------------------ |
| 80    | HTTP       | Web khÃ´ng mÃ£ hÃ³a      |
| 443   | HTTPS      | Web cÃ³ mÃ£ hÃ³a SSL/TLS |
| 22    | SSH        | Remote shell access      |
| 21    | FTP        | File transfer            |
| 3306  | MySQL      | Database                 |
| 5432  | PostgreSQL | Database                 |
| 27017 | MongoDB    | NoSQL Database           |
| 6379  | Redis      | Cache/Queue              |

### 1.3 DNS (Domain Name System)

- Chuyá»ƒn Ä‘á»•i tÃªn miá»n â†’ IP address
- **Security concern**: DNS Spoofing, DNS Hijacking
- **Pentest use**: Subdomain enumeration

---

## 2. HTTP Protocol Deep Dive

### 2.1 HTTP Request Structure

```http
GET /api/users/123 HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
Cookie: session=abc123
Content-Type: application/json
```

**CÃ¡c pháº§n quan trá»ng:**

- **Method**: GET, POST, PUT, DELETE, PATCH, OPTIONS
- **Headers**: Chá»©a metadata cá»§a request
- **Body**: Data gá»­i lÃªn (POST/PUT)

### 2.2 HTTP Response Structure

```http
HTTP/1.1 200 OK
Content-Type: application/json
Set-Cookie: session=xyz789; HttpOnly; Secure
X-Frame-Options: DENY

{"id": 123, "name": "John"}
```

### 2.3 HTTP Methods vÃ  Security

| Method    | Má»¥c Ä‘Ã­ch    | Security Concern      |
| --------- | -------------- | --------------------- |
| GET       | Láº¥y data      | Sensitive data in URL |
| POST      | Táº¡o má»›i      | CSRF attacks          |
| PUT/PATCH | Cáº­p nháº­t     | Authorization bypass  |
| DELETE    | XÃ³a           | Unauthorized deletion |
| OPTIONS   | CORS preflight | CORS misconfiguration |

### 2.4 Important Headers for Security

| Header                        | Má»¥c Ä‘Ã­ch            |
| ----------------------------- | ---------------------- |
| `Authorization`             | Chá»©a token xÃ¡c thá»±c |
| `Cookie`                    | Session data           |
| `Content-Security-Policy`   | NgÄƒn XSS              |
| `X-Frame-Options`           | NgÄƒn Clickjacking     |
| `Strict-Transport-Security` | Force HTTPS            |
| `X-Content-Type-Options`    | NgÄƒn MIME sniffing    |

---

## 3. Web Security Concepts

### 3.1 Same-Origin Policy (SOP)

**Äá»‹nh nghÄ©a:** Browser chá»‰ cho phÃ©p script tá»« cÃ¹ng origin truy cáº­p data cá»§a nhau.

**Origin = Protocol + Host + Port**

```
https://example.com:443/page
  â”‚         â”‚        â”‚
Protocol  Host     Port
```

**VÃ­ dá»¥:**

| URL                          | Same Origin vá»›i `https://example.com`? |
| ---------------------------- | ----------------------------------------- |
| `https://example.com/api`  | âœ… Yes                                    |
| `http://example.com`       | âŒ No (khÃ¡c protocol)                    |
| `https://api.example.com`  | âŒ No (khÃ¡c subdomain)                   |
| `https://example.com:8080` | âŒ No (khÃ¡c port)                        |

### 3.2 CORS (Cross-Origin Resource Sharing)

**Má»¥c Ä‘Ã­ch:** Cho phÃ©p requests tá»« origin khÃ¡c má»™t cÃ¡ch cÃ³ kiá»ƒm soÃ¡t.

```http
# Request tá»« https://frontend.com
Origin: https://frontend.com

# Response tá»« https://api.com
Access-Control-Allow-Origin: https://frontend.com
Access-Control-Allow-Methods: GET, POST
Access-Control-Allow-Credentials: true
```

**Common Misconfigurations:**

- `Access-Control-Allow-Origin: *` + `Allow-Credentials: true` âŒ
- Dynamic origin reflection khÃ´ng verify âŒ
- Null origin allowed âŒ

### 3.3 Cookies vÃ  Session

**Cookie Attributes:**

| Attribute    | Má»¥c Ä‘Ã­ch                      | Security               |
| ------------ | -------------------------------- | ---------------------- |
| `HttpOnly` | KhÃ´ng accessible tá»« JavaScript | NgÄƒn XSS steal cookie |
| `Secure`   | Chá»‰ gá»­i qua HTTPS              | NgÄƒn sniffing         |
| `SameSite` | Kiá»ƒm soÃ¡t cross-site requests  | NgÄƒn CSRF             |
| `Domain`   | Cookie scope                     | Subdomains             |
| `Path`     | URL path scope                   | Directory isolation    |

**VÃ­ dá»¥ Cookie an toÃ n:**

```
Set-Cookie: session=abc123; HttpOnly; Secure; SameSite=Strict; Path=/
```

---

## 4. Authentication vs Authorization

### 4.1 Authentication (XÃ¡c thá»±c)

> "Báº¡n lÃ  ai?" - Verify identity

**CÃ¡c phÆ°Æ¡ng phÃ¡p:**

- **Session-based**: Server lÆ°u session, client giá»¯ session ID
- **Token-based (JWT)**: Stateless, client giá»¯ signed token
- **OAuth 2.0**: Third-party authentication (Google, Facebook)
- **API Keys**: Simple, thÆ°á»ng cho machine-to-machine

### 4.2 Authorization (PhÃ¢n quyá»n)

> "Báº¡n Ä‘Æ°á»£c lÃ m gÃ¬?" - Access control

**Models:**

- **RBAC** (Role-Based): User â†’ Role â†’ Permissions
- **ABAC** (Attribute-Based): Rules dá»±a trÃªn attributes
- **ACL** (Access Control List): Explicit permissions per resource

---

## 5. Encoding vs Encryption vs Hashing

| Concept              | Má»¥c Ä‘Ã­ch              | Reversible? | Use Case                 |
| -------------------- | ------------------------ | ----------- | ------------------------ |
| **Encoding**   | Chuyá»ƒn Ä‘á»•i format     | âœ… Yes      | Base64, URL encoding     |
| **Encryption** | Báº£o vá»‡ confidentiality | âœ… With key | Data at rest, in transit |
| **Hashing**    | Integrity, fingerprint   | âŒ No       | Passwords, checksums     |

### 5.1 Encoding Examples

```javascript
// Base64
btoa("Hello") // "SGVsbG8="
atob("SGVsbG8=") // "Hello"

// URL Encoding
encodeURIComponent("<script>") // "%3Cscript%3E"
```

### 5.2 Encryption Types

- **Symmetric**: CÃ¹ng key Ä‘á»ƒ encrypt/decrypt (AES)
- **Asymmetric**: Public/Private key pair (RSA)

### 5.3 Hashing

```
MD5("password")     â†’ 5f4dcc3b5aa765d61d8327deb882cf99  (WEAK!)
SHA256("password")  â†’ 5e884898da280471... (Better)
bcrypt("password")  â†’ $2b$10$... (Best for passwords)
```

**Quan trá»ng:** KhÃ´ng bao giá» dÃ¹ng MD5/SHA1 cho passwords!

---

## 6. TLS/SSL

### 6.1 TLS Handshake (Simplified)

```
Client                          Server
   â”‚                               â”‚
   â”‚â”€â”€â”€ ClientHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚â—€â”€â”€ ServerHello + Certificate â”€â”‚
   â”‚â”€â”€â”€ Key Exchange â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚â—€â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                               â”‚
   â”‚â—€â•â• Encrypted Communication â•â•â–¶â”‚
```

### 6.2 Certificate Validation

Browser kiá»ƒm tra:

1. Certificate chÆ°a expired?
2. Domain name match?
3. Signed bá»Ÿi trusted CA?
4. Certificate khÃ´ng bá»‹ revoke?

**Pentest concerns:**

- Self-signed certificates
- Expired certificates
- Certificate pinning bypass

---

## âœ… Checklist - Báº¡n Ä‘Ã£ hiá»ƒu chÆ°a?

- [X] CÃ³ thá»ƒ explain Ä‘Æ°á»£c TCP/IP model?
- [X] Hiá»ƒu HTTP request/response structure?
- [X] Biáº¿t Same-Origin Policy hoáº¡t Ä‘á»™ng tháº¿ nÃ o?
- [X] PhÃ¢n biá»‡t Ä‘Æ°á»£c Encoding/Encryption/Hashing?
- [X] Hiá»ƒu Cookie attributes vÃ  security implications?
- [X] Biáº¿t sá»± khÃ¡c nhau giá»¯a Authentication vÃ  Authorization?

---

## ğŸ“– Äá»c thÃªm

- MDN Web Docs: [HTTP Overview](https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview)
- OWASP: [Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)
